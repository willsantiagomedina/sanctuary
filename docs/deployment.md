# Deployment

This document outlines the deployment process for the Sanctuary application, covering both the frontend applications (Web and Electron) and the backend services (Convex and Cloudflare Worker).

For specific details regarding general deployment strategies, refer to the root `DEPLOYMENT.md` file. This document will focus on how each component of the monorepo is deployed.

## Overview of Deployment Targets

*   **Web Application (`apps/web`)**: Typically deployed as a static site (e.g., to Cloudflare Pages, Vercel, Netlify) or served from a CDN.
*   **Electron Application (`apps/electron`)**: Packaged into executables for various operating systems (Windows, macOS, Linux) and distributed to users.
*   **Convex Backend (`packages/convex`)**: Deployed directly to the Convex cloud platform.
*   **Cloudflare Worker (`workers/bible-proxy`)**: Deployed to Cloudflare's global edge network.

## Web Application Deployment (`apps/web`)

The `apps/web` application is a static site generated by Vite.

1.  **Build**:
    ```bash
    cd apps/web
    bun run build
    ```
    This command generates optimized static assets in the `apps/web/dist` directory.

2.  **Hosting**: The contents of the `dist` directory are then uploaded to a static site hosting provider.
    *   **Cloudflare Pages**: If using Cloudflare Pages, the `wrangler.toml` in `apps/web/` would define the build command and publish directory. CI/CD pipelines (e.g., `.github/workflows/deploy.yml`) would automate this.

## Electron Application Deployment (`apps/electron`)

The Electron application is built and packaged using `electron-builder`.

1.  **Build**:
    ```bash
    cd apps/electron
    bun run build
    ```
    This script typically executes `electron-builder` which compiles the application and creates installers/executables for the configured platforms.

2.  **Distribution**: The generated artifacts (e.g., `.dmg`, `.exe`, `.AppImage`) are then distributed to end-users. This can be done via manual downloads, an auto-update mechanism, or a release pipeline.
    *   **GitHub Releases**: The `.github/workflows/electron-release.yml` workflow indicates that releases are automated via GitHub Actions, which builds, signs (if configured), and uploads artifacts to GitHub Releases.

## Convex Backend Deployment (`packages/convex`)

The Convex backend is deployed and managed entirely by the Convex CLI and platform.

1.  **Deployment**:
    ```bash
    cd packages/convex
    bun run deploy
    ```
    This command pushes local changes to your Convex project, including schema updates, new queries, mutations, and actions. Convex handles the hot-reloading and versioning.

2.  **Environment Variables**: Ensure that Convex project settings for environment variables are correctly configured in the Convex dashboard for different environments (e.g., production, staging).

## Cloudflare Worker Deployment (`workers/bible-proxy`)

The Cloudflare Worker is deployed using the `wrangler` CLI.

1.  **Build and Deploy**:
    ```bash
    cd workers/bible-proxy
    bun run deploy
    ```
    (Assuming a `deploy` script exists in `package.json` that calls `wrangler deploy`). Otherwise, `wrangler deploy` can be run directly.

2.  **Configuration**: The `wrangler.toml` file contains all necessary deployment configuration, including environment-specific settings and bindings.
